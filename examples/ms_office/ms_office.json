{
  "x": {
    "rename": {
      // {{-import-}}: this key can't be renamed, and the value should not contain any placeholders
      "{{-cmd-}}": "{cmd}", // ensure it comes alphabetically after {inp} and {out}
      "{{-cur-dir-}}": "{cur-dir}",
      "{{-can-expand-content-}}": "{can-expand-content}",

      // Allows to get list of files before command, hence a file will
      // be processed by every command before taking on the next file
      "{{-early-wildcard-expansion-}}": "{EWE}",

      "{{-inp-}}": "{inp}",
      "{{-inp-dir-}}": "{inp-dir}",
      "{{-inp-ext-}}": "{inp-ext}",
      "{{-inp-name-}}": "{inp-name}",
      "{{-inp-name-ext-}}": "{inp-name-ext}",
      "{{-inp-path-}}": "{inp-path}",
      "{{-inp-sub-dir-}}": "{inp-sub-dir}",
      "{{-inp-sub-path-}}": "{inp-sub-path}",
      "{{-out-}}": "{out}",
      "{{-this-}}": "{this}"
    },
    "action": [
      {
        "{can-expand-content}": false
      },

      // import commands
      { "{{-import-}}": "cmd.json" },

      // import data
      { "{{-import-}}": "ms_office_data.json?path=$.data.*" },

      {
        "{unz-dir}":  "{cur-dir}/unz/{inp-name-ext}.dir",
        "{out-file}": "{cur-dir}/out/{inp-name}-<last-name>-<given-names>{inp-ext}",

        // Early wildcard expansion
        "{EWE}": true,

        // Go through all MS Office input files
        "{inp}": "inp/*",

        "{cfg-curr}": "{cur-dir}/unz/ms_office_curr.json",

        "{cmd}": [
          // Expand template config file
          "expand-content \"{cur-dir}/ms_office_tmpl.json\" \"{cfg-curr}\"",

          // Decompress file
          "sub --unzip \"{inp}\" \"{unz-dir}\"",

          // Expand placeholders in every decompressed file
          "sub --dir \"{unz-dir}\" --config \"{cfg-curr}\"",

          // Compress back to a single file
          "sub --zip --move \"{unz-dir}\" \"{out-file}\"",

          // Delete temp expanded config file
          "sub --delete \"{cfg-curr}\""
        ],

        // Make a signal to start processing (command, input and output files are all defined
        "{out}": ""
      },

      // Stop branching array elements and execute a single command
      { "reset": null, "{cmd}": "{delete} \"{cur-dir}/unz\"" }
    ]
  }
}
