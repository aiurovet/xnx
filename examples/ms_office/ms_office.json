{
  "x": {
    "rename": {
      // {{-import-}}: this key can't be renamed, and the value should not contain any placeholders
      "{{-cmd-}}": "{cmd}", // ensure it comes alphabetically after {inp} and {out}
      "{{-cur-dir-}}": "{cur-dir}",
      "{{-can-expand-content-}}": "{can-expand-content}",

      "{{-early-wildcard-expansion-}}": "{EWE}", // allows to get list of files before command, hence a file will be
                                                 // processed by every command before taking on the next file

      "{{-inp-}}": "{inp}",
      "{{-inp-dir-}}": "{inp-dir}",
      "{{-inp-ext-}}": "{inp-ext}",
      "{{-inp-name-}}": "{inp-name}",
      "{{-inp-name-ext-}}": "{inp-name-ext}",
      "{{-inp-path-}}": "{inp-path}",
      "{{-inp-sub-dir-}}": "{inp-sub-dir}",
      "{{-inp-sub-path-}}": "{inp-sub-path}",
      "{{-out-}}": "{out}",
      "{{-this-}}": "{this}"
    },
    "action": [
      {
        "{can-expand-content}": false,
        "{cur-dir}": ".",
        "{start-dir}": "{cur-dir}"
      },

      { "{{-import-}}": "cmd.json" }, // import commands

      {
        "{unz-dir}":  "{cur-dir}/unz/{inp-name-ext}.dir",
        "{out-file}": "{cur-dir}/out/{inp-name}-{last-name}-{given-names}{inp-ext}",

        "{EWE}": true, // should be explicit bool

        "{inp}": "inp/*", // go through all MS Office input files

        "{cmd}": [
          "sub --unzip \"{inp}\" \"{unz-dir}\"",           // decompress file
          "sub --config \"{cur-dir}/ms_office_data.json\" \"{unz-dir}\" \"{inp-name}\" \"{inp-ext}\"", // make expansions (inside the same executable)
          //"sub --zip --move \"{unz-dir}\" \"{out-file}\"", // compress back (inside the same executable)
          "{delete} \"{cur-dir}/unz\""                     // delete uncompressed dir
        ],

        "{out}": ""
      }
    ]
  }
}
