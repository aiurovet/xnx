{
  "x": {
    "rename": {
      // {{-import-}}: this key can't be renamed, and the value should not contain any placeholders
      "{{-cmd-}}": "{cmd}",
      "{{-cur-dir-}}": "{cur-dir}",
      "{{-can-replace-content-}}": "{can-replace-content}",
      "{{-inp-}}": "{inp}",
      "{{-inp-dir-}}": "{inp-dir}",
      "{{-inp-ext-}}": "{inp-ext}",
      "{{-inp-name-}}": "{inp-name}",
      "{{-inp-name-ext-}}": "{inp-name-ext}",
      "{{-inp-path-}}": "{inp-path}",
      "{{-inp-sub-dir-}}": "{inp-sub-dir}",
      "{{-inp-sub-path-}}": "{inp-sub-path}",
      "{{-out-}}": "{out}"
    },
    "action": [
      { "{can-replace-content}": false, "{cur-dir}": ".", "{start-dir}": "{cur-dir}" },

      { "{{-import-}}": "cmd.json" }, // key can't be renamed, value should not contain any placeholders

      {
        "{inp-unz-top}": "{cur-dir}/inp_unz",
        "{inp-unz-dir}": "{inp-unz-top}/{inp-name-ext}.dir",
        "{out-top}":     "{cur-dir}/out",
        "{out-file}":    "{out-top}/{inp-name}-{last-name}{inp-ext}",
        "{tmp-file}":    "{out-top}/{inp-sub-path}"
      },

      // Decompress source files into directories

      {
        "{inp}": "$*", "{out}": "",
        //"{cmd}": "cmd/my_unzip \"{inp-unz-dir}\" \"{inp}\"",
        "{zip_dir}": "{inp-unz-dir}",
        "{zip_inp}": "{inp}",
        "{cmd}": [ "{mkdir} \"{inp-unz-dir}\"", "{unzip}", "{mkdir} \"{out-top}\"" ]
      },

      // Multi-copy decompressed source directories to destinations

      {
        "{inp}": "$*",
        "{cmd}": "{copy} \"{inp-unz-top}/{inp-name-ext}.dir\" \"{out-file}.dir\"",
        "{out}": "",
        "{{-import-}}": "ms_office_data.json" // key can't be renamed, value should not contain any placeholders
      },

      // Expand placeholders and compress to the new file

      {
        "{inp}": "{out-top}/**", /* all files // in all subdirectories */
        //"{inp}": "{inp-unz-dir}/**", /* all files // in all subdirectories */
        "{cmd}": "replace-only",
        "{out}": "{tmp-file}",
        "{{-import-}}": "ms_office_data.json" // value should not contain any placeholders
      },

      // Compress output directories file

      {
        "{inp}": "$*",
        "{zip_dir}": "{out-file}.dir",
        "{zip_out}": "{out-file}",
        //"{cmd}": [ "cd \"{zip_dir}\" && {zip} && cd .. && {remove} \"{zip_dir}\"" ],
        "{cmd}": [ "{zip} && cd .. && {remove} \"{zip_dir}\"" ],
        "{out}": "",
        "{{-import-}}": "ms_office_data.json" // value should not contain any placeholders
      },

      // Delete input directories file

      {
        "{inp}": "", "{out}": "",
        "{cmd}": "{remove} \"{inp-unz-top}\""
      }
    ]
  }
}
