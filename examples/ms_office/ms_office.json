{
  "rename": {
    // {{-import-}}: this key can't be renamed, and the value should not contain any placeholders
    "{{-cmd-}}": "{cmd}",
    "{{-cur-dir-}}": "{cur-dir}",
    "{{-can-expand-content-}}": "{can-expand-content}",
    "{{-drop-}}": "{drop}",
    "{{-expand-content-}}": "{expand-content}",
    "{{-exec-}}": "{run}",

    "{{-inp-}}": "{inp}",
    "{{-inp-dir-}}": "{inp-dir}",
    "{{-inp-ext-}}": "{inp-ext}",
    "{{-inp-name-}}": "{inp-name}",
    "{{-inp-name-ext-}}": "{inp-name-ext}",
    "{{-inp-path-}}": "{inp-path}",
    "{{-inp-sub-dir-}}": "{inp-sub-dir}",
    "{{-inp-sub-path-}}": "{inp-sub-path}",
    "{{-out-}}": "{out}",
    "{{-sub-}}": "{sub}",
    "{{-this-}}": "{this}"
  },
  "action": {
    "{can-expand-content}": false,
    "{compression}": 6, // just to show the capability; 6 is the default

    "{unz-dir}":  "{cur-dir}/unz/{inp-name-ext}.dir",
    "{out-file}": "{cur-dir}/out/{inp-name}-<last-name>-<given-names>{inp-ext}",

    "{cfg-curr}": "{cur-dir}/unz/ms_office_curr.json",

    "{R}": [
      {
        // Go through all MS Office input files
        "{inp}": "{cur-dir}/inp/*",

        // Import data
        "{{-import-}}": "ms_office_data.json?path=$.data.*",

        "{run}": [
          // Expand template config file
          "{expand-content} \"ms_office_tmpl.json\" \"{cfg-curr}\"",

          // Decompress file
          "{sub} --unzip \"{inp}\" \"{unz-dir}\"",

          // Expand placeholders in every decompressed file
          "{sub} --dir \"{unz-dir}\" --config \"{cfg-curr}\"",

          // Compress back to a single file
          "{sub} -p {compression} --zip --move \"{unz-dir}\" \"{out-file}\"",

          // Delete temp expanded config file
          "{sub} --delete \"{cfg-curr}\""
        ]
      },
      {
        // Remove all possible temporary files
        "{run}": "{sub} --delete \"unz\""
      }
    ]
  }
}
