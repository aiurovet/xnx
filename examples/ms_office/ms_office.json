{
  "x": {
    "rename": {
      // {{-import-}}: this key can't be renamed, and the value should not contain any placeholders
      "{{-cmd-}}": "{zmd}", // ensure it comes alphabetically after {inp} and {out}
      "{{-cur-dir-}}": "{cur-dir}",
      "{{-can-replace-content-}}": "{can-replace-content}",
      "{{-inp-}}": "{inp}",
      "{{-inp-dir-}}": "{inp-dir}",
      "{{-inp-ext-}}": "{inp-ext}",
      "{{-inp-name-}}": "{inp-name}",
      "{{-inp-name-ext-}}": "{inp-name-ext}",
      "{{-inp-path-}}": "{inp-path}",
      "{{-inp-sub-dir-}}": "{inp-sub-dir}",
      "{{-inp-sub-path-}}": "{inp-sub-path}",
      "{{-out-}}": "{out}",
      "{{-this-}}": "{this}"
    },
    "action": [
      {
        "{can-replace-content}": false,
        "{cur-dir}": ".",
        "{start-dir}": "{cur-dir}"
      },

      { "{{-import-}}": "cmd.json" }, // import commands
      { "{{-import-}}": "ms_office_data.json,x/action/data" }, // import just substitution data array

      {
        "{unz-dir}":  "{cur-dir}/unz/{inp-name-ext}.dir",
        "{out-file}": "{cur-dir}/out/{inp-name}-{last-name}-{given-names}{inp-ext}",

        "{inp}": "inp/*", "{out}": "", // go through all MS Office input files

        "{zmd}": [
          "sub --unzip \"{inp}\" \"{unz-dir}\"",           // decompress file
          "sub --dir \"{unz-dir}\" --config \"{cur-dir}/ms_office_data.json\"", // make replacements (inside the same executable)
          "sub --zip --move \"{unz-dir}\" \"{out-file}\"", // compress back (inside the same executable)
          "{delete} \"{cur-dir}/unz\""                     // delete uncompressed dir
        ]
      }
    ]
  }
}
