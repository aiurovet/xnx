#!/bin/bash

################################################################################

PRJ_NAME="xnx"
OST="${1}"
shift

################################################################################

ICO_DIR=$( dirname "${0}" )
SCR_DIR=$( dirname "${ICO_DIR}" )

################################################################################

if [[ "${OST}" == "" ]]; then
    OST=$(uname -s)
fi

if [[ "${OST}" =~ "darwin" ]]; then
    OST="macOS"
fi

printf "\nRunning on ${OST}\n\n"

################################################################################

BIN_OST="${SCR_DIR}/../bin/${OST}"
PRJ_EXE="${BIN_OST}/${PRJ_NAME}"

if [ ! -f "${PRJ_EXE}" ]; then
  "${SCR_DIR}/build" || exit 1
fi

################################################################################

"${PRJ_EXE}" -d "${ICO_DIR}" ${@} || exit 1

exit 0

################################################################################
